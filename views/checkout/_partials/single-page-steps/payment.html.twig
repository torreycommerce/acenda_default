
{% set payment_platform = api.get('order/platform') %}

<form id="payment-form"  novalidate parsley-validate>

{% if payment_platform.platform == 'Braintree' %}
	<h3>Payment Method</h3>	
	{{ app.asset.js('https://js.braintreegateway.com/web/dropin/1.7.0/js/dropin.js') }}
	 <input id="nonce" name="payment_method_nonce" type="hidden" />
	    <div id="dropin-container"></div>


{% else %}
<h3>Credit Card</h3>	
	<div class="row">
		<div class="col-6 col-lg-7">
			<div class="form-group fgq">
				<label class="control-label" for="checkout_card_number">Card Number</label>
				{{ forms.text('card_number', checkout.card_number, {id:'checkout_card_number',class:'form-control parsley-validated', placeholder:"Card Number", required:true, 'parsley-luhn': true, 'parsley-type': 'number'}) }}
				<div class="validation">{{ forms.errorlist(form_errors, 'card_number') }}</div>
			</div>
		</div>
		<div class="col-6 col-lg-5">
			<div style="margin: auto;" class="form-group" id="checkout-cards">
				<label>&nbsp;</label>
				<div class="row row-thin">
					<div class="col-3 col-thin">
						<div class="checkout-card">
							<div class="image-space is60 checkout-card">
								<img src="{{app.url_asset}}/assets/images/creditcards/visa.png" class="img-fluid isd cc-visa" width="73" height="44" alt="">
							</div>
						</div>
					</div>
					<div class="col-3 col-thin">
						<div class="checkout-card">
							<div class="image-space is60 checkout-card">
								<img src="{{app.url_asset}}/assets/images/creditcards/mastercard.png" class="img-fluid isd cc-mastercard" width="73" height="44" alt="">
							</div>
						</div>
					</div>
					<div class="col-3 col-thin">
						<div class="checkout-card">
							<div class="image-space is60 checkout-card">
								<img src="{{app.url_asset}}/assets/images/creditcards/amex.png" class="img-fluid isd cc-amex" width="73" height="44" alt="">
							</div>
						</div>
					</div>
					<div class="col-3 col-thin">
						<div class="checkout-card">
							<div class="image-space is60 checkout-card">
								<img src="{{app.url_asset}}/assets/images/creditcards/discover.png" class="img-fluid isd cc-discover" width="73" height="44" alt="">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-4">
			<div class="form-group fgq">
				<label class="control-label" for="ccv">CVV2</label>
				{{ forms.text('card_cvv2', checkout.card_cvv2, {class:'form-control parsley-validated', id:'ccv', placeholder:"CVV2", required:true, 'pattern':'^[0-9]{3,4}$'}) }}
				<div class="validation">{{ forms.errorlist(form_errors, 'card_cvv2') }}</div>
			</div>
		</div>
		<div class="col-4">
			<div class="form-group fgq">
				<label class="control-label" for="exp-m">Exp Month</label>
				{% set months = {} %}
				{% for i in range(1,12) %}
					{% set month = "%02d"|format(i) %}
					{% set months = months + {(month):month} %}
				{% endfor %}
				{{ forms.select('card_exp_month', checkout.card_exp_month, months, {class:'form-control parsley-validated', id:'exp-m'}) }}
				<div class="validation">{{ forms.errorlist(form_errors, 'card_exp_month') }}</div>
			</div>
		</div>
		<div class="col-4">
			<div class="form-group fgq">
				<label class="control-label" for="exp-y">Exp Year</label>
				{% set years = {} %}
				{% for i in range(now|date('Y'),now|date('Y')+15) %}
					{% set years = years + {(i):i} %}
				{% endfor %}
				{{ forms.select('card_exp_year', checkout.card_exp_year, years, {class:'form-control parsley-validated', id:'exp-y'}) }}
				<div class="validation">{{ forms.errorlist(form_errors, 'card_exp_year') }}</div>
			</div>
		</div>
	</div>
{% endif %}
<h3>Billing Address</h3>
<div class="row" id="billing-address-preview">
</div>
<div class="copy-shipping-flag">
	<div class="form-group custom-control custom-checkbox">
		<input type="checkbox" class="custom-control-input" id="copy_shipping_to_billing2" name="copy_shipping_to_billing" value="">
		<label class="custom-control-label" for="copy_shipping_to_billing2">Billing Address is the same as the Shipping Address</label>
	</div>
</div>
<div id="billing-address" style="display:block;">

	<div id="customer-addresses" style="display: none;">
		<div class="form-group">
			<label class="control-label" for="billing-customer-addresses-select">Select an Address</label>		
			<select class="form-control" id="billing-customer-addresses-select">
			</select>
            <div class="validation"></div>			
		</div>
	</div>
	<div id="billing-address-form">
		<div class="hide-billing">
			<div class="row">
				<div class="col-6">
					<div class="form-group fgq">
						<label class="control-label" for="billing-first-name">First Name</label>
						{{ forms.text('billing_first_name', '', {class:'form-control parsley-validated', id:'billing-first-name', placeholder:"First Name", required:true}) }}
						<div class="validation">{{ forms.errorlist(form_errors, name ~ 'first_name') }}</div>
					</div>
				</div>
				<div class="col-6">
					<div class="form-group fgq">
						<label class="control-label" for="billing-last-name">Last Name</label>
						{{ forms.text('billing_last_name', '', {class:'form-control parsley-validated', id:'billing-last-name', placeholder:"Last Name", required:true}) }}
						<div class="validation">{{ forms.errorlist(form_errors, name ~ 'last_name') }}</div>
					</div>
				</div>
			</div>
	     	<fieldset class="verify-change-billing">
	     	<div class="row">
				<div class="col-md-6">
					<div class="form-group fgq normalizable">
						<label class="control-label" for="billing-country">Country</label>
						{{ forms.select('billing_country', '', {}, {class:'form-control parsley-validated', id:'billing-country', required:true}) }}
						<div class="validation">{{ forms.errorlist(form_errors, name ~ 'country') }}</div>
					</div>
				</div>
			</div>
			<div class="form-group fgq normalizable">
				<label class="control-label" for="billing-addr-1">Address Line 1</label>
				{{ forms.text('billing_street_line1', '', {class:'form-control parsley-validated', id:'billing-addr-1', placeholder:"Address Line 1", required:true}) }}
				<div class="validation">{{ forms.errorlist(form_errors, name ~ 'street_line1') }}</div>
			</div>
			<div class="form-group normalizable">
				<label class="control-label" for="billing-addr-2">Address Line 2</label>
				{{ forms.text( 'billing_street_line2', '', {class:'form-control parsley-validated', id:'billing-addr-2', placeholder:"Address Line 2"}) }}
				<div class="validation">{{ forms.errorlist(form_errors, name ~ 'street_line2') }}</div>
			</div>
			<div class="row">
				<div class="col-6">
					<div class="form-group fgq normalizable">
						<label class="control-label" for="billing-city">City</label>
						{{ forms.text('billing_city','', {class:'form-control parsley-validated', id:'billing-city', placeholder:"City", required:true}) }}
						<div class="validation">{{ forms.errorlist(form_errors, name ~ 'city') }}</div>
					</div>
				</div>
				<div class="col-6">
					<div class="form-group fgq normalizable">
						<label class="control-label" id="billing-state-label" for="billing-state">State/Province</label>
		                {{ forms.select('billing_state_select', '', {}, {class:'form-control parsley-validated', placeholder:"State", id:'billing-state-select'}) }}
                        {{ forms.text('billing_state_text', '', {class:'form-control', placeholder:"State/Province", id:'billing-state-text'}) }}    		                
		                <div class="validation">{{ forms.errorlist(form_errors, name ~ 'state') }}</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-6">
					<div class="form-group fgq normalizable">
						<label class="control-label" for="billing-zip" id="billing-zip-label">Zip Code</label>
						{{ forms.text('billing_zip', '', {class:'form-control parsley-validated', id:'billing-zip', placeholder:"Zip Code", required:true}) }}
						<div class="validation">{{ forms.errorlist(form_errors, name ~ 'zip') }}</div>
					</div>
				</div>
				<div class="col-6">
					<div class="form-group fgq">
						<label class="control-label" for="billing-phone">Phone Number</label>
						{{ forms.text('billing_phone_number', '', {class:'form-control parsley-validated', id:'billing-phone', placeholder:"Phone Number", required: true}) }}
						<div class="validation">{{ forms.errorlist(form_errors, name ~ 'phone_number') }}</div>
					</div>
				</div>
			</div>
			<div id="billing-save" style="display: none;">
				<div class="form-group custom-control custom-checkbox">
					<input type="checkbox" class="custom-control-input" id="billing_save" name="billing_save" value="">
					<label class="custom-control-label" for="billing_save">Save this address for future use?</label>
				</div>
			</div>
		  </fieldset>
	    </div>
	</div>	
</div>

<div id="address-verify"></div>
</form>

<button id="btn-continue-payment" class="btn btn-lg btn-primary btn-cart btn-xs-block float-right">Continue</button>
	